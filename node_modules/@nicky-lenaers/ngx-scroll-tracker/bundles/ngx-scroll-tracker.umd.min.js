!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/platform-browser"),require("rxjs")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","@angular/platform-browser","rxjs"],t):t((e.ng=e.ng||{},e.ng["ngx-scroll-tracker"]=e.ng["ngx-scroll-tracker"]||{}),e.ng.core,e.ng.common,e.ng.platformBrowser,e.rxjs)}(this,function(e,t,r,n,o){"use strict";var i=function(){function e(){this._container_manager=new Map}return e.prototype.register=function(e,t){var r=this,n=this._getFirstScrollableParentNode(e.nativeElement);if(!this._container_manager.has(n)){this._container_manager.set(n,{children:new Map,listener:function(e){return r._isElementInContainerView(e,n)}});var i=this._container_manager.get(n).listener;t.listen(this._getListenerTarget(n),"scroll",i),t.listen(this._getListenerTarget(n),"resize",i)}var a=new o.ReplaySubject;return this._container_manager.get(n).children.set(e,a),this._isElementInContainerView(new Event("ngx-scroll-tracker-initial-event"),n),a.asObservable()},e.prototype._getListenerTarget=function(e){return"BODY"===e.tagName?window:e},e.prototype._isElementInContainerView=function(e,t){var r=this,n=t.getBoundingClientRect();this._container_manager.get(t).children.forEach(function(o,i,a){var c=i.nativeElement.getBoundingClientRect(),s=c.bottom-c.top,l=r._isWindow(r._getListenerTarget(t))?window.innerHeight:n.bottom-n.top,u=r._isWindow(r._getListenerTarget(t))?0:n.top,p={$event:e,elementRef:i,data:{elementTop:{fromContainerTop:{pixels:c.top-u,ratio:(c.top-u)/l},fromContainerBottom:{pixels:c.top-(l+u),ratio:(c.top-(l+u))/l}},elementBottom:{fromContainerTop:{pixels:c.top+s-u,ratio:(c.top+s-u)/l},fromContainerBottom:{pixels:c.top+s-(l+u),ratio:(c.top+s-(l+u))/l}}}};r._container_manager.get(t).children.get(i).next(p)})},e.prototype._isWindow=function(e){return e===window},e.prototype._getFirstScrollableParentNode=function(e,t){void 0===t&&(t=!0);var r=window.getComputedStyle(e),n=t?/(auto|scroll|hidden)/:/(auto|scroll)/;if("fixed"===r.position)throw new Error("Scroll item cannot be positioned 'fixed'");for(var o=e;o=o.parentElement;)if("absolute"!==(r=window.getComputedStyle(o)).position){if("BODY"===o.tagName)return o;if(n.test(r.overflow+r.overflowY+r.overflowX))return o}throw new Error("No scrollable parent found for element "+e)},e.prototype._unregister=function(e){var t=this;this._container_manager.forEach(function(r,n,o){r.children.forEach(function(r,o,i){o.nativeElement===e.nativeElement&&(t._container_manager.get(n).children.delete(o),0===t._container_manager.get(n).children.size&&t._container_manager.delete(n))})})},e}();i.decorators=[{type:t.Injectable}],i.ctorParameters=function(){return[]};var a=function(){function e(e,r,n,o,i){this._element_ref=e,this._scrollTrackerService=r,this._renderer2=n,this._document=o,this._platform_id=i,this.ngxScrollTrackerHandler=new t.EventEmitter}return e.prototype.ngAfterContentInit=function(){var e=this;r.isPlatformServer(this._platform_id)||setTimeout(function(t){e._subscription=e._scrollTrackerService.register(e._element_ref,e._renderer2).finally(function(){return e._cleanup()}).subscribe(function(t){return e.ngxScrollTrackerHandler.emit(t)},function(e){return console.error(e)})})},e.prototype.ngOnDestroy=function(){r.isPlatformServer(this._platform_id)||this._cleanup()},e.prototype._cleanup=function(){this._subscription.unsubscribe()},e}();a.decorators=[{type:t.Directive,args:[{selector:"[ngx-scroll-tracker]"}]}],a.ctorParameters=function(){return[{type:t.ElementRef},{type:i},{type:t.Renderer2},{type:void 0,decorators:[{type:t.Inject,args:[n.DOCUMENT]}]},{type:void 0,decorators:[{type:t.Inject,args:[t.PLATFORM_ID]}]}]},a.propDecorators={ngxScrollTrackerHandler:[{type:t.Output,args:["ngx-scroll-tracker"]}]};var c=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[i]}},e}();c.decorators=[{type:t.NgModule,args:[{imports:[r.CommonModule],declarations:[a],exports:[a]}]}],c.ctorParameters=function(){return[]},e.ScrollTrackerModule=c,Object.defineProperty(e,"__esModule",{value:!0})});