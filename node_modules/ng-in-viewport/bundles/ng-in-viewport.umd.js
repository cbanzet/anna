(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('rxjs'), require('@angular/common'), require('rxjs/operators')) :
    typeof define === 'function' && define.amd ? define('ng-in-viewport', ['exports', '@angular/core', 'rxjs', '@angular/common', 'rxjs/operators'], factory) :
    (factory((global['ng-in-viewport'] = {}),global.ng.core,global.rxjs,global.ng.common,global.rxjs.operators));
}(this, (function (exports,i0,rxjs,common,operators) { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m)
            return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)
                ar.push(r.value);
        }
        catch (error) {
            e = { error: error };
        }
        finally {
            try {
                if (r && !r.done && (m = i["return"]))
                    m.call(i);
            }
            finally {
                if (e)
                    throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++)
            ar = ar.concat(__read(arguments[i]));
        return ar;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /** @enum {string} */
    var InViewportConfigDirection = {
        BOTH: 'both',
        VERTICAL: 'vertical',
        HORIZONTAL: 'horizontal',
    };
    var /** @type {?} */ DEFAULT_THRESHOLD = [0, 1];
    var InViewportConfig = (function () {
        function InViewportConfig(options) {
            var _this = this;
            this._rootMargin = '0px 0px 0px 0px';
            this._threshold = __spread(DEFAULT_THRESHOLD);
            this._partial = true;
            this._direction = InViewportConfigDirection.BOTH;
            if (Object.prototype.toString.call(options) === '[object Object]') {
                ['root', 'rootMargin', 'threshold', 'partial', 'direction', 'checkFn'].forEach(function (prop) {
                    if (options.hasOwnProperty(prop)) {
                        _this[prop] = options[prop];
                    }
                });
            }
        }
        Object.defineProperty(InViewportConfig.prototype, "root", {
            get: /**
             * @return {?}
             */ function () {
                return this._root;
            },
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) {
                this._root = value && value.nodeType === 1 ? value : undefined;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(InViewportConfig.prototype, "rootMargin", {
            get: /**
             * @return {?}
             */ function () {
                return this._rootMargin;
            },
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) {
                this._rootMargin = value && typeof value === 'string' ? value : '0px 0px 0px 0px';
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(InViewportConfig.prototype, "threshold", {
            get: /**
             * @return {?}
             */ function () {
                return this._threshold;
            },
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) {
                var /** @type {?} */ threshold = [];
                var /** @type {?} */ isValidThreshold = function (val) { return typeof val === 'number' && val >= 0 && val <= 1; };
                if (isValidThreshold(value)) {
                    threshold = [value];
                }
                else if (Array.isArray(value) && value.length) {
                    threshold = value.filter(function (val) { return isValidThreshold(val); });
                }
                if (threshold.length === 0) {
                    threshold = __spread(DEFAULT_THRESHOLD);
                }
                this._threshold = threshold;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(InViewportConfig.prototype, "partial", {
            get: /**
             * @return {?}
             */ function () {
                return this._partial;
            },
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) {
                this._partial = !!value;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(InViewportConfig.prototype, "direction", {
            get: /**
             * @return {?}
             */ function () {
                return this._direction;
            },
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) {
                var /** @type {?} */ isValidValue = function (val) {
                    return ([
                        InViewportConfigDirection.BOTH,
                        InViewportConfigDirection.HORIZONTAL,
                        InViewportConfigDirection.VERTICAL
                    ].indexOf(val) >= 0);
                };
                this._direction = isValidValue(value) ? value : InViewportConfigDirection.BOTH;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(InViewportConfig.prototype, "checkFn", {
            get: /**
             * @return {?}
             */ function () {
                return this._checkFn;
            },
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) {
                this._checkFn = value;
            },
            enumerable: true,
            configurable: true
        });
        return InViewportConfig;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var InViewportService = (function () {
        function InViewportService(ngZone) {
            this.ngZone = ngZone;
            this.trigger$ = new rxjs.Subject();
            this.registry = [];
        }
        /**
         * @param {?} entries
         * @return {?}
         */
        InViewportService.prototype.emitTrigger = /**
         * @param {?} entries
         * @return {?}
         */
            function (entries) {
                var _this = this;
                if (Array.isArray(entries) && entries.length) {
                    entries.forEach(function (entry) { return _this.trigger$.next(entry); });
                }
            };
        /**
         * @param {?=} element
         * @return {?}
         */
        InViewportService.prototype.getRootElement = /**
         * @param {?=} element
         * @return {?}
         */
            function (element) {
                return element && element.nodeType === Node.ELEMENT_NODE ? element : undefined;
            };
        /**
         * @param {?} root
         * @return {?}
         */
        InViewportService.prototype.findEntry = /**
         * @param {?} root
         * @return {?}
         */
            function (root) {
                var _this = this;
                return this.registry.find(function (entry) { return entry.root === _this.getRootElement(root); });
            };
        /**
         * @param {?} target
         * @param {?} config
         * @return {?}
         */
        InViewportService.prototype.register = /**
         * @param {?} target
         * @param {?} config
         * @return {?}
         */
            function (target, config) {
                var _this = this;
                this.ngZone.runOutsideAngular(function () {
                    var /** @type {?} */ foundedEntry = _this.findEntry(config.root);
                    if (foundedEntry && !foundedEntry.targets.has(target)) {
                        foundedEntry.targets.add(target);
                        foundedEntry.observer.observe(target);
                    }
                    else {
                        var /** @type {?} */ options = {
                            root: _this.getRootElement(config.root),
                            rootMargin: config.rootMargin,
                            threshold: config.threshold
                        };
                        var /** @type {?} */ entry = {
                            root: _this.getRootElement(config.root),
                            targets: new Set([target]),
                            observer: new IntersectionObserver(function (entries) { return _this.ngZone.run(function () { return _this.emitTrigger(entries); }); }, options)
                        };
                        entry.observer.observe(target);
                        _this.registry = __spread(_this.registry, [entry]);
                    }
                });
            };
        /**
         * @param {?} target
         * @param {?} config
         * @return {?}
         */
        InViewportService.prototype.unregister = /**
         * @param {?} target
         * @param {?} config
         * @return {?}
         */
            function (target, config) {
                var _this = this;
                this.ngZone.runOutsideAngular(function () {
                    var /** @type {?} */ foundedEntry = _this.findEntry(config.root);
                    if (foundedEntry) {
                        var observer = foundedEntry.observer, targets = foundedEntry.targets;
                        if (targets.has(target)) {
                            observer.unobserve(target);
                            targets.delete(target);
                        }
                        if (targets.size === 0) {
                            observer.disconnect();
                            _this.registry = _this.registry.filter(function (entry) { return entry !== foundedEntry; });
                        }
                    }
                });
            };
        InViewportService.decorators = [
            { type: i0.Injectable, args: [{
                        providedIn: 'root'
                    },] },
        ];
        /** @nocollapse */
        InViewportService.ctorParameters = function () {
            return [
                { type: i0.NgZone, },
            ];
        };
        /** @nocollapse */ InViewportService.ngInjectableDef = i0.defineInjectable({ factory: function InViewportService_Factory() { return new InViewportService(i0.inject(i0.NgZone)); }, token: InViewportService, providedIn: "root" });
        return InViewportService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var /** @type {?} */ InViewportMetadata = Symbol('InViewportMetadata');
    var InViewportDirective = (function () {
        function InViewportDirective(platformId, elementRef, inViewport) {
            this.platformId = platformId;
            this.elementRef = elementRef;
            this.inViewport = inViewport;
            this.config = new InViewportConfig();
            this.subscription = new rxjs.Subscription();
            this.inViewportAction = new i0.EventEmitter();
        }
        Object.defineProperty(InViewportDirective.prototype, "options", {
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) {
                this.config = new InViewportConfig(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        InViewportDirective.prototype.ngAfterViewInit = /**
         * @return {?}
         */
            function () {
                var _this = this;
                if (common.isPlatformBrowser(this.platformId)) {
                    this.inViewport.register(this.elementRef.nativeElement, this.config);
                    this.subscription.add(this.inViewport.trigger$
                        .pipe(operators.filter(function (entry) { return entry && entry.target === _this.elementRef.nativeElement; }))
                        .subscribe(function (entry) { return _this.emitAction(entry, false); }));
                }
                else {
                    this.emitAction(undefined, true);
                }
            };
        /**
         * @return {?}
         */
        InViewportDirective.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                this.subscription.unsubscribe();
                if (common.isPlatformBrowser(this.platformId)) {
                    this.inViewport.unregister(this.elementRef.nativeElement, this.config);
                }
            };
        /**
         * @param {?} entry
         * @param {?} force
         * @return {?}
         */
        InViewportDirective.prototype.check = /**
         * @param {?} entry
         * @param {?} force
         * @return {?}
         */
            function (entry, force) {
                var _this = this;
                var /** @type {?} */ isVisible = function () {
                    var /** @type {?} */ partiallyVisible = entry.isIntersecting || entry.intersectionRatio > 0;
                    var /** @type {?} */ completelyVisible = entry.intersectionRatio >= 1;
                    return _this.config.partial ? partiallyVisible : completelyVisible;
                };
                var /** @type {?} */ visible = force || !entry || isVisible();
                return _a = {}, _a[InViewportMetadata] = { entry: entry }, _a.target = this.elementRef.nativeElement, _a.visible = visible, _a;
                var _a;
            };
        /**
         * @param {?} entry
         * @param {?} force
         * @return {?}
         */
        InViewportDirective.prototype.emitAction = /**
         * @param {?} entry
         * @param {?} force
         * @return {?}
         */
            function (entry, force) {
                var /** @type {?} */ event = this.config.checkFn
                    ? this.config.checkFn(entry, { force: force, config: this.config })
                    : this.check(entry, force);
                this.inViewportAction.emit(event);
            };
        InViewportDirective.decorators = [
            { type: i0.Directive, args: [{
                        selector: '[inViewport]'
                    },] },
        ];
        /** @nocollapse */
        InViewportDirective.ctorParameters = function () {
            return [
                { type: Object, decorators: [{ type: i0.Inject, args: [i0.PLATFORM_ID,] },] },
                { type: i0.ElementRef, },
                { type: InViewportService, },
            ];
        };
        InViewportDirective.propDecorators = {
            "options": [{ type: i0.Input, args: ['inViewportOptions',] },],
            "inViewportAction": [{ type: i0.Output },],
        };
        return InViewportDirective;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var InViewportModule = (function () {
        function InViewportModule() {
        }
        InViewportModule.decorators = [
            { type: i0.NgModule, args: [{
                        imports: [common.CommonModule],
                        declarations: [InViewportDirective],
                        exports: [InViewportDirective]
                    },] },
        ];
        return InViewportModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    exports.InViewportModule = InViewportModule;
    exports.InViewportMetadata = InViewportMetadata;
    exports.InViewportDirective = InViewportDirective;
    exports.InViewportService = InViewportService;
    exports.InViewportConfigDirection = InViewportConfigDirection;
    exports.InViewportConfig = InViewportConfig;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctaW4tdmlld3BvcnQudW1kLmpzLm1hcCIsInNvdXJjZXMiOltudWxsLCJuZzovL25nLWluLXZpZXdwb3J0L2xpYi9pbi12aWV3cG9ydC1jb25maWcudHMiLCJuZzovL25nLWluLXZpZXdwb3J0L2xpYi9pbi12aWV3cG9ydC5zZXJ2aWNlLnRzIiwibmc6Ly9uZy1pbi12aWV3cG9ydC9saWIvaW4tdmlld3BvcnQuZGlyZWN0aXZlLnRzIiwibmc6Ly9uZy1pbi12aWV3cG9ydC9saWIvaW4tdmlld3BvcnQubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0geVtvcFswXSAmIDIgPyBcInJldHVyblwiIDogb3BbMF0gPyBcInRocm93XCIgOiBcIm5leHRcIl0pICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gWzAsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7ICB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpZiAob1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCJleHBvcnQgZW51bSBJblZpZXdwb3J0Q29uZmlnRGlyZWN0aW9uIHtcbiAgQk9USCA9ICdib3RoJyxcbiAgVkVSVElDQUwgPSAndmVydGljYWwnLFxuICBIT1JJWk9OVEFMID0gJ2hvcml6b250YWwnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5WaWV3cG9ydENvbmZpZ0NoZWNrRm5PcHRpb25zIHtcbiAgZm9yY2U6IGJvb2xlYW47XG4gIGNvbmZpZzogSW5WaWV3cG9ydENvbmZpZztcbn1cblxuZXhwb3J0IHR5cGUgSW5WaWV3cG9ydENvbmZpZ0NoZWNrRm4gPSAoXG4gIGVudHJ5OiBJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5LFxuICBvcHRpb25zOiBJblZpZXdwb3J0Q29uZmlnQ2hlY2tGbk9wdGlvbnNcbikgPT4gYW55O1xuXG5leHBvcnQgaW50ZXJmYWNlIEluVmlld3BvcnRDb25maWdPcHRpb25zIHtcbiAgcm9vdD86IEVsZW1lbnQ7XG4gIHJvb3RNYXJnaW4/OiBzdHJpbmc7XG4gIHRocmVzaG9sZD86IG51bWJlciB8IG51bWJlcltdO1xuICBwYXJ0aWFsPzogYm9vbGVhbjtcbiAgZGlyZWN0aW9uPzogSW5WaWV3cG9ydENvbmZpZ0RpcmVjdGlvbjtcbiAgY2hlY2tGbj86IEluVmlld3BvcnRDb25maWdDaGVja0ZuO1xufVxuXG5jb25zdCBERUZBVUxUX1RIUkVTSE9MRCA9IFswLCAxXTtcblxuZXhwb3J0IGNsYXNzIEluVmlld3BvcnRDb25maWcge1xuICBwcml2YXRlIF9yb290OiBFbGVtZW50O1xuICBwcml2YXRlIF9yb290TWFyZ2luOiBzdHJpbmcgPSAnMHB4IDBweCAwcHggMHB4JztcbiAgcHJpdmF0ZSBfdGhyZXNob2xkOiBudW1iZXIgfCBudW1iZXJbXSA9IFsuLi5ERUZBVUxUX1RIUkVTSE9MRF07XG4gIHByaXZhdGUgX3BhcnRpYWw6IGJvb2xlYW4gPSB0cnVlO1xuICBwcml2YXRlIF9kaXJlY3Rpb246IEluVmlld3BvcnRDb25maWdEaXJlY3Rpb24gPSBJblZpZXdwb3J0Q29uZmlnRGlyZWN0aW9uLkJPVEg7XG4gIHByaXZhdGUgX2NoZWNrRm46IEluVmlld3BvcnRDb25maWdDaGVja0ZuO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM/OiBJblZpZXdwb3J0Q29uZmlnT3B0aW9ucykge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob3B0aW9ucykgPT09ICdbb2JqZWN0IE9iamVjdF0nKSB7XG4gICAgICBbJ3Jvb3QnLCAncm9vdE1hcmdpbicsICd0aHJlc2hvbGQnLCAncGFydGlhbCcsICdkaXJlY3Rpb24nLCAnY2hlY2tGbiddLmZvckVhY2goKHByb3ApID0+IHtcbiAgICAgICAgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcbiAgICAgICAgICB0aGlzW3Byb3BdID0gb3B0aW9uc1twcm9wXTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGdldCByb290KCk6IEVsZW1lbnQge1xuICAgIHJldHVybiB0aGlzLl9yb290O1xuICB9XG5cbiAgcHVibGljIHNldCByb290KHZhbHVlOiBFbGVtZW50KSB7XG4gICAgdGhpcy5fcm9vdCA9IHZhbHVlICYmIHZhbHVlLm5vZGVUeXBlID09PSAxID8gdmFsdWUgOiB1bmRlZmluZWQ7XG4gIH1cblxuICBwdWJsaWMgZ2V0IHJvb3RNYXJnaW4oKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fcm9vdE1hcmdpbjtcbiAgfVxuXG4gIHB1YmxpYyBzZXQgcm9vdE1hcmdpbih2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5fcm9vdE1hcmdpbiA9IHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyB2YWx1ZSA6ICcwcHggMHB4IDBweCAwcHgnO1xuICB9XG5cbiAgcHVibGljIGdldCB0aHJlc2hvbGQoKTogbnVtYmVyIHwgbnVtYmVyW10ge1xuICAgIHJldHVybiB0aGlzLl90aHJlc2hvbGQ7XG4gIH1cblxuICBwdWJsaWMgc2V0IHRocmVzaG9sZCh2YWx1ZTogbnVtYmVyIHwgbnVtYmVyW10pIHtcbiAgICBsZXQgdGhyZXNob2xkID0gW107XG4gICAgY29uc3QgaXNWYWxpZFRocmVzaG9sZCA9ICh2YWw6IGFueSkgPT4gdHlwZW9mIHZhbCA9PT0gJ251bWJlcicgJiYgdmFsID49IDAgJiYgdmFsIDw9IDE7XG4gICAgaWYgKGlzVmFsaWRUaHJlc2hvbGQodmFsdWUpKSB7XG4gICAgICB0aHJlc2hvbGQgPSBbdmFsdWVdO1xuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoKSB7XG4gICAgICB0aHJlc2hvbGQgPSB2YWx1ZS5maWx0ZXIoKHZhbCkgPT4gaXNWYWxpZFRocmVzaG9sZCh2YWwpKTtcbiAgICB9XG4gICAgaWYgKHRocmVzaG9sZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocmVzaG9sZCA9IFsuLi5ERUZBVUxUX1RIUkVTSE9MRF07XG4gICAgfVxuICAgIHRoaXMuX3RocmVzaG9sZCA9IHRocmVzaG9sZDtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgcGFydGlhbCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fcGFydGlhbDtcbiAgfVxuXG4gIHB1YmxpYyBzZXQgcGFydGlhbCh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX3BhcnRpYWwgPSAhIXZhbHVlO1xuICB9XG5cbiAgcHVibGljIGdldCBkaXJlY3Rpb24oKTogSW5WaWV3cG9ydENvbmZpZ0RpcmVjdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuX2RpcmVjdGlvbjtcbiAgfVxuXG4gIHB1YmxpYyBzZXQgZGlyZWN0aW9uKHZhbHVlOiBJblZpZXdwb3J0Q29uZmlnRGlyZWN0aW9uKSB7XG4gICAgY29uc3QgaXNWYWxpZFZhbHVlID0gKHZhbDogYW55KSA9PiB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICBbXG4gICAgICAgICAgSW5WaWV3cG9ydENvbmZpZ0RpcmVjdGlvbi5CT1RILFxuICAgICAgICAgIEluVmlld3BvcnRDb25maWdEaXJlY3Rpb24uSE9SSVpPTlRBTCxcbiAgICAgICAgICBJblZpZXdwb3J0Q29uZmlnRGlyZWN0aW9uLlZFUlRJQ0FMXG4gICAgICAgIF0uaW5kZXhPZih2YWwpID49IDBcbiAgICAgICk7XG4gICAgfTtcbiAgICB0aGlzLl9kaXJlY3Rpb24gPSBpc1ZhbGlkVmFsdWUodmFsdWUpID8gdmFsdWUgOiBJblZpZXdwb3J0Q29uZmlnRGlyZWN0aW9uLkJPVEg7XG4gIH1cblxuICBwdWJsaWMgZ2V0IGNoZWNrRm4oKTogSW5WaWV3cG9ydENvbmZpZ0NoZWNrRm4ge1xuICAgIHJldHVybiB0aGlzLl9jaGVja0ZuO1xuICB9XG5cbiAgcHVibGljIHNldCBjaGVja0ZuKHZhbHVlOiBJblZpZXdwb3J0Q29uZmlnQ2hlY2tGbikge1xuICAgIHRoaXMuX2NoZWNrRm4gPSB2YWx1ZTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgSW5qZWN0YWJsZSwgTmdab25lIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBJblZpZXdwb3J0Q29uZmlnIH0gZnJvbSAnLi9pbi12aWV3cG9ydC1jb25maWcnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEluVmlld3BvcnRSZWdpc3RyeUVudHJ5IHtcbiAgcm9vdDogRWxlbWVudDtcbiAgdGFyZ2V0czogU2V0PEVsZW1lbnQ+O1xuICBvYnNlcnZlcjogSW50ZXJzZWN0aW9uT2JzZXJ2ZXI7XG59XG5cbmV4cG9ydCB0eXBlIEluVmlld3BvcnRUcmlnZ2VyID0gU3ViamVjdDxJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5PjtcbmV4cG9ydCB0eXBlIEluVmlld3BvcnRSZWdpc3RyeSA9IEluVmlld3BvcnRSZWdpc3RyeUVudHJ5W107XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIEluVmlld3BvcnRTZXJ2aWNlIHtcbiAgcHVibGljIHJlYWRvbmx5IHRyaWdnZXIkOiBJblZpZXdwb3J0VHJpZ2dlciA9IG5ldyBTdWJqZWN0PEludGVyc2VjdGlvbk9ic2VydmVyRW50cnk+KCk7XG4gIHByaXZhdGUgcmVnaXN0cnk6IEluVmlld3BvcnRSZWdpc3RyeSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbmdab25lOiBOZ1pvbmUpIHt9XG5cbiAgcHJpdmF0ZSBlbWl0VHJpZ2dlcihlbnRyaWVzOiBJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5W10pIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShlbnRyaWVzKSAmJiBlbnRyaWVzLmxlbmd0aCkge1xuICAgICAgZW50cmllcy5mb3JFYWNoKChlbnRyeSkgPT4gdGhpcy50cmlnZ2VyJC5uZXh0KGVudHJ5KSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRSb290RWxlbWVudChlbGVtZW50PzogRWxlbWVudCkge1xuICAgIHJldHVybiBlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFID8gZWxlbWVudCA6IHVuZGVmaW5lZDtcbiAgfVxuXG4gIHByaXZhdGUgZmluZEVudHJ5KHJvb3Q6IEVsZW1lbnQpIHtcbiAgICByZXR1cm4gdGhpcy5yZWdpc3RyeS5maW5kKChlbnRyeSkgPT4gZW50cnkucm9vdCA9PT0gdGhpcy5nZXRSb290RWxlbWVudChyb290KSk7XG4gIH1cblxuICBwdWJsaWMgcmVnaXN0ZXIodGFyZ2V0OiBFbGVtZW50LCBjb25maWc6IEluVmlld3BvcnRDb25maWcpOiB2b2lkIHtcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICBjb25zdCBmb3VuZGVkRW50cnkgPSB0aGlzLmZpbmRFbnRyeShjb25maWcucm9vdCk7XG4gICAgICBpZiAoZm91bmRlZEVudHJ5ICYmICFmb3VuZGVkRW50cnkudGFyZ2V0cy5oYXModGFyZ2V0KSkge1xuICAgICAgICBmb3VuZGVkRW50cnkudGFyZ2V0cy5hZGQodGFyZ2V0KTtcbiAgICAgICAgZm91bmRlZEVudHJ5Lm9ic2VydmVyLm9ic2VydmUodGFyZ2V0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnM6IGFueSA9IHtcbiAgICAgICAgICByb290OiB0aGlzLmdldFJvb3RFbGVtZW50KGNvbmZpZy5yb290KSxcbiAgICAgICAgICByb290TWFyZ2luOiBjb25maWcucm9vdE1hcmdpbixcbiAgICAgICAgICB0aHJlc2hvbGQ6IGNvbmZpZy50aHJlc2hvbGRcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZW50cnk6IEluVmlld3BvcnRSZWdpc3RyeUVudHJ5ID0ge1xuICAgICAgICAgIHJvb3Q6IHRoaXMuZ2V0Um9vdEVsZW1lbnQoY29uZmlnLnJvb3QpLFxuICAgICAgICAgIHRhcmdldHM6IG5ldyBTZXQoW3RhcmdldF0pLFxuICAgICAgICAgIG9ic2VydmVyOiBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoXG4gICAgICAgICAgICAoZW50cmllczogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeVtdKSA9PiB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5lbWl0VHJpZ2dlcihlbnRyaWVzKSksXG4gICAgICAgICAgICBvcHRpb25zXG4gICAgICAgICAgKVxuICAgICAgICB9O1xuICAgICAgICBlbnRyeS5vYnNlcnZlci5vYnNlcnZlKHRhcmdldCk7XG4gICAgICAgIHRoaXMucmVnaXN0cnkgPSBbLi4udGhpcy5yZWdpc3RyeSwgZW50cnldO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIHVucmVnaXN0ZXIodGFyZ2V0OiBFbGVtZW50LCBjb25maWc6IEluVmlld3BvcnRDb25maWcpOiB2b2lkIHtcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICBjb25zdCBmb3VuZGVkRW50cnkgPSB0aGlzLmZpbmRFbnRyeShjb25maWcucm9vdCk7XG4gICAgICBpZiAoZm91bmRlZEVudHJ5KSB7XG4gICAgICAgIGNvbnN0IHsgb2JzZXJ2ZXIsIHRhcmdldHMgfSA9IGZvdW5kZWRFbnRyeTtcbiAgICAgICAgaWYgKHRhcmdldHMuaGFzKHRhcmdldCkpIHtcbiAgICAgICAgICBvYnNlcnZlci51bm9ic2VydmUodGFyZ2V0KTtcbiAgICAgICAgICB0YXJnZXRzLmRlbGV0ZSh0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0YXJnZXRzLnNpemUgPT09IDApIHtcbiAgICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgdGhpcy5yZWdpc3RyeSA9IHRoaXMucmVnaXN0cnkuZmlsdGVyKChlbnRyeSkgPT4gZW50cnkgIT09IGZvdW5kZWRFbnRyeSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgRGlyZWN0aXZlLFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIEluamVjdCxcbiAgSW5wdXQsXG4gIE9uRGVzdHJveSxcbiAgT3V0cHV0LFxuICBQTEFURk9STV9JRFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IGlzUGxhdGZvcm1Ccm93c2VyIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5pbXBvcnQgeyBJblZpZXdwb3J0Q29uZmlnLCBJblZpZXdwb3J0Q29uZmlnT3B0aW9ucyB9IGZyb20gJy4vaW4tdmlld3BvcnQtY29uZmlnJztcbmltcG9ydCB7IEluVmlld3BvcnRTZXJ2aWNlIH0gZnJvbSAnLi9pbi12aWV3cG9ydC5zZXJ2aWNlJztcblxuZXhwb3J0IGNvbnN0IEluVmlld3BvcnRNZXRhZGF0YSA9IFN5bWJvbCgnSW5WaWV3cG9ydE1ldGFkYXRhJyk7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ1tpblZpZXdwb3J0XSdcbn0pXG5leHBvcnQgY2xhc3MgSW5WaWV3cG9ydERpcmVjdGl2ZSBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSB7XG4gIHByaXZhdGUgY29uZmlnOiBJblZpZXdwb3J0Q29uZmlnID0gbmV3IEluVmlld3BvcnRDb25maWcoKTtcbiAgcHJpdmF0ZSByZWFkb25seSBzdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbiA9IG5ldyBTdWJzY3JpcHRpb24oKTtcblxuICBASW5wdXQoJ2luVmlld3BvcnRPcHRpb25zJylcbiAgcHJpdmF0ZSBzZXQgb3B0aW9ucyh2YWx1ZTogSW5WaWV3cG9ydENvbmZpZ09wdGlvbnMpIHtcbiAgICB0aGlzLmNvbmZpZyA9IG5ldyBJblZpZXdwb3J0Q29uZmlnKHZhbHVlKTtcbiAgfVxuXG4gIEBPdXRwdXQoKSBwdWJsaWMgcmVhZG9ubHkgaW5WaWV3cG9ydEFjdGlvbjogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtSWQ6IE9iamVjdCxcbiAgICBwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXG4gICAgcHJpdmF0ZSBpblZpZXdwb3J0OiBJblZpZXdwb3J0U2VydmljZVxuICApIHt9XG5cbiAgcHVibGljIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xuICAgICAgdGhpcy5pblZpZXdwb3J0LnJlZ2lzdGVyKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCB0aGlzLmNvbmZpZyk7XG4gICAgICB0aGlzLnN1YnNjcmlwdGlvbi5hZGQoXG4gICAgICAgIHRoaXMuaW5WaWV3cG9ydC50cmlnZ2VyJFxuICAgICAgICAgIC5waXBlKGZpbHRlcigoZW50cnk6IEludGVyc2VjdGlvbk9ic2VydmVyRW50cnkpID0+IGVudHJ5ICYmIGVudHJ5LnRhcmdldCA9PT0gdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQpKVxuICAgICAgICAgIC5zdWJzY3JpYmUoKGVudHJ5OiBJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5KSA9PiB0aGlzLmVtaXRBY3Rpb24oZW50cnksIGZhbHNlKSlcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZW1pdEFjdGlvbih1bmRlZmluZWQsIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XG4gICAgICB0aGlzLmluVmlld3BvcnQudW5yZWdpc3Rlcih0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgdGhpcy5jb25maWcpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2hlY2soZW50cnk6IEludGVyc2VjdGlvbk9ic2VydmVyRW50cnksIGZvcmNlOiBib29sZWFuKSB7XG4gICAgY29uc3QgaXNWaXNpYmxlID0gKCkgPT4ge1xuICAgICAgY29uc3QgcGFydGlhbGx5VmlzaWJsZSA9IGVudHJ5LmlzSW50ZXJzZWN0aW5nIHx8IGVudHJ5LmludGVyc2VjdGlvblJhdGlvID4gMDtcbiAgICAgIGNvbnN0IGNvbXBsZXRlbHlWaXNpYmxlID0gZW50cnkuaW50ZXJzZWN0aW9uUmF0aW8gPj0gMTtcbiAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5wYXJ0aWFsID8gcGFydGlhbGx5VmlzaWJsZSA6IGNvbXBsZXRlbHlWaXNpYmxlO1xuICAgIH07XG4gICAgY29uc3QgdmlzaWJsZSA9IGZvcmNlIHx8ICFlbnRyeSB8fCBpc1Zpc2libGUoKTtcbiAgICByZXR1cm4geyBbSW5WaWV3cG9ydE1ldGFkYXRhXTogeyBlbnRyeSB9LCB0YXJnZXQ6IHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCB2aXNpYmxlIH07XG4gIH1cblxuICBwcml2YXRlIGVtaXRBY3Rpb24oZW50cnk6IEludGVyc2VjdGlvbk9ic2VydmVyRW50cnksIGZvcmNlOiBib29sZWFuKTogdm9pZCB7XG4gICAgY29uc3QgZXZlbnQgPSB0aGlzLmNvbmZpZy5jaGVja0ZuXG4gICAgICA/IHRoaXMuY29uZmlnLmNoZWNrRm4oZW50cnksIHsgZm9yY2UsIGNvbmZpZzogdGhpcy5jb25maWcgfSlcbiAgICAgIDogdGhpcy5jaGVjayhlbnRyeSwgZm9yY2UpO1xuICAgIHRoaXMuaW5WaWV3cG9ydEFjdGlvbi5lbWl0KGV2ZW50KTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgTmdNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBJblZpZXdwb3J0RGlyZWN0aXZlIH0gZnJvbSAnLi9pbi12aWV3cG9ydC5kaXJlY3RpdmUnO1xuXG5ATmdNb2R1bGUoe1xuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlXSxcbiAgZGVjbGFyYXRpb25zOiBbSW5WaWV3cG9ydERpcmVjdGl2ZV0sXG4gIGV4cG9ydHM6IFtJblZpZXdwb3J0RGlyZWN0aXZlXVxufSlcbmV4cG9ydCBjbGFzcyBJblZpZXdwb3J0TW9kdWxlIHt9XG4iXSwibmFtZXMiOlsiU3ViamVjdCIsIkluamVjdGFibGUiLCJOZ1pvbmUiLCJTdWJzY3JpcHRpb24iLCJFdmVudEVtaXR0ZXIiLCJpc1BsYXRmb3JtQnJvd3NlciIsImZpbHRlciIsIkRpcmVjdGl2ZSIsIkluamVjdCIsIlBMQVRGT1JNX0lEIiwiRWxlbWVudFJlZiIsIklucHV0IiwiT3V0cHV0IiwiTmdNb2R1bGUiLCJDb21tb25Nb2R1bGUiXSwi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